# 栈溢出攻击实验

> "Exploiting is an art, but understanding the principles behind it is science." —— Anon

## 目录
- [简介](#简介)
- [栈溢出攻击原理](#栈溢出攻击原理)
- [实验目的](#实验目的)
- [实验环境](#实验环境)
- [实验步骤](#实验步骤)
- [注意事项](#注意事项)

## 简介
栈溢出攻击是一种常见的安全漏洞利用技术，它通过向程序的栈内存区域写入超出预期的数据量，导致覆盖相邻内存区域的数据，从而可能改变程序的执行流程。这种攻击手法可以用来执行恶意代码，获取系统权限，或者使服务崩溃。

## 栈溢出攻击原理
在计算机科学中，函数调用时会创建一个称为“栈帧”或“活动记录”的数据结构，用于存储局部变量、函数参数、返回地址等信息。栈是后进先出（LIFO）的数据结构，这意味着最后压入栈的数据将最先被弹出。当发生函数调用时，新的栈帧会被压入栈顶；当函数返回时，该栈帧从栈顶弹出。

### 栈溢出的过程
1. **缓冲区分配**：当函数调用发生时，为局部变量分配一定的栈空间。
2. **用户输入**：如果函数接收了来自用户的输入，并且没有正确地检查输入长度，就可能导致写入的数据超过局部变量所分配的空间。
3. **栈帧覆盖**：过长的数据将覆盖栈上的其他信息，包括函数的返回地址。
4. **控制流劫持**：攻击者可以通过精心构造的输入来覆盖返回地址，使得函数返回时跳转到攻击者指定的代码位置，通常是恶意代码所在的位置。
### 栈溢出的一个简单例子
```
#比方说现在有人向你暴露了一个操作接口，你还通过一些手段知道了这个操作背后是这样的代码
char s[24];
get(s);
```
实际上这个代码相当的不安全，这是因为get(s)可以让用户输出很长的字符串，从而影响了函数栈本身。
比方说这个这段代码所调用的函数栈如下
```
                                           +-----------------+
                                           |     retaddr     |
                                           +-----------------+
                                           |     saved ebp   |
                                    ebp--->+-----------------+
                                           |                 |
                                           |                 |
                                           |                 |
                                           |                 |
                                           |                 |
                                           |                 |
                              esp=ebp-0x14-->+-----------------+
```

## 实验目的
本实验旨在让参与者理解栈溢出攻击的基本原理，学会如何检测潜在的栈溢出漏洞，并掌握基本的防护措施。

## 实验环境
- 操作系统：Linux (Ubuntu 18.04 或更高版本)
- 编译器：GCC
- 其他工具：gdb, objdump

## 实验步骤
1. 安装必要的软件包。
2. 编写存在栈溢出漏洞的C语言程序。
3. 使用gdb调试工具分析程序运行时的栈状态。
4. 尝试构造输入以触发栈溢出。
5. 分析攻击成功的原因，讨论可能的防御策略。

## 注意事项
- 在实验过程中，请确保在一个受控环境中进行，避免对真实系统造成影响。
- 学习和实践安全知识的目的是提高系统的安全性，而不是用于非法目的。
- 实验完成后，应清理所有测试代码，确保不留安全隐患。
